<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cluster taxon- or sample-wise — findClusters • seqgroup</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Cluster taxon- or sample-wise — findClusters" />
<meta property="og:description" content="Cluster sequencing data taxon- or sample-wise.
By default, data are clustered sample-wise. The default method is
Dirichlet-Multinomial mixtures (DMM) using the DirichletMultinomial package.
Note that DMM expects counts and fails if there are taxa that are absent across all samples.
Consequently, abundances are scaled to counts and taxa absent across all samples are removed.
Also note that counts should not be too large for DMM (not above 10000). If this is the case,
they will be scaled (divided by a constant and rounded). In addition, for DMM, the total number
of counts should be the same across samples.
Partitioning around medoids (PAM) does not expect counts, can deal with absent taxa and large counts.
The cluster number can be omitted, in which case the best cluster number is determined in the range
provided using either silhouette or a cluster quality index implemented in clusterCrit's function intCriteria." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">seqgroup</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/seqgroup_tour.html">seqgroup tour</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cluster taxon- or sample-wise</h1>
    
    <div class="hidden name"><code>findClusters.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Cluster sequencing data taxon- or sample-wise.
By default, data are clustered sample-wise. The default method is
Dirichlet-Multinomial mixtures (DMM) using the DirichletMultinomial package.
Note that DMM expects counts and fails if there are taxa that are absent across all samples.
Consequently, abundances are scaled to counts and taxa absent across all samples are removed.
Also note that counts should not be too large for DMM (not above 10000). If this is the case,
they will be scaled (divided by a constant and rounded). In addition, for DMM, the total number
of counts should be the same across samples.
Partitioning around medoids (PAM) does not expect counts, can deal with absent taxa and large counts.
The cluster number can be omitted, in which case the best cluster number is determined in the range
provided using either silhouette or a cluster quality index implemented in clusterCrit's function intCriteria.</p>
    </div>

    <pre class="usage"><span class='fu'>findClusters</span>(
  <span class='no'>abundances</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"dmm"</span>,
  <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>,
  <span class='kw'>minK</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>maxK</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>qualityIndex</span> <span class='kw'>=</span> <span class='st'>"silhouette"</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>abundances</th>
      <td><p>a matrix with taxa as rows and samples as columns</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>clustering method, supported are dmm and pam</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>cluster number, can be set to NA if cluster number is to be determined with a quality index</p></td>
    </tr>
    <tr>
      <th>minK</th>
      <td><p>the minimum cluster number to test</p></td>
    </tr>
    <tr>
      <th>maxK</th>
      <td><p>the maximum cluster number to test</p></td>
    </tr>
    <tr>
      <th>qualityIndex</th>
      <td><p>by default silhouette computed with silhouette function on bray curtis, can also be CH, Dunn, and other quality indices supported by clusterCrit's intCriteria function or none</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a cluster membership vector</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"ibd_taxa"</span>)
<span class='co'># unequal sample sums in the example data set are due to the removal of low-prevalence taxa</span>
<span class='no'>clusters</span><span class='kw'>=</span><span class='fu'>findClusters</span>(<span class='no'>ibd_taxa</span>, <span class='kw'>k</span><span class='kw'>=</span><span class='fl'>NA</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"pam"</span>, <span class='kw'>qualityIndex</span><span class='kw'>=</span><span class='st'>"CH"</span>)</div><div class='output co'>#&gt; [1] "k equal 2 has quality value 16.0904817118765"
#&gt; [1] "k equal 3 has quality value 15.6880504982704"
#&gt; [1] "k equal 4 has quality value 12.8737754811385"
#&gt; [1] "k equal 5 has quality value 13.7168831544949"
#&gt; [1] "k equal 6 has quality value 13.9996390736813"
#&gt; [1] "k equal 7 has quality value 14.0650955457399"
#&gt; [1] "k equal 8 has quality value 13.7596433029095"
#&gt; [1] "k equal 9 has quality value 13.7172891077008"
#&gt; [1] "k equal 10 has quality value 13.65667748236"
#&gt; [1] "The optimal cluster number according to Calinski_Harabasz is 2 with value 16.0904817118765"</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>clusters</span>)</div><div class='output co'>#&gt; clusters
#&gt;   1   2 
#&gt; 147   8 </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Karoline Faust.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


