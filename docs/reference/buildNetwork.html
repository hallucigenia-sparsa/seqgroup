<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Build a microbial network — buildNetwork • seqgroup</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Build a microbial network — buildNetwork" />

<meta property="og:description" content="Wrapper for microbial network inference methods.
SPIEC-EASI, CoNet (see function barebonesCoNet) and bnlearn are supported.
Abundances are assumed to have been already filtered and transformed.
The function returns the network as an igraph object,
with nodes labeled and colored at the selected taxonomic levels
and, for SPIEC-EASI and CoNet, edges in red or green, depending on whether they
represent negative or positive associations." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">seqgroup</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/seqgroup_tour.html">seqgroup tour</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Build a microbial network</h1>
    
    <div class="hidden name"><code>buildNetwork.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Wrapper for microbial network inference methods.
SPIEC-EASI, CoNet (see function <code><a href='barebonesCoNet.html'>barebonesCoNet</a></code>) and bnlearn are supported.
Abundances are assumed to have been already filtered and transformed.
The function returns the network as an igraph object,
with nodes labeled and colored at the selected taxonomic levels
and, for SPIEC-EASI and CoNet, edges in red or green, depending on whether they
represent negative or positive associations.</p>
    
    </div>

    <pre class="usage"><span class='fu'>buildNetwork</span>(<span class='no'>abundances</span>, <span class='kw'>lineages</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"mb"</span>, <span class='kw'>repNum</span> <span class='kw'>=</span> <span class='fl'>20</span>,
  <span class='kw'>minStrength</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>renorm</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>initEdgeNum</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>methodNum</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>directed</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>nameLevel</span> <span class='kw'>=</span> <span class='st'>"Genus"</span>, <span class='kw'>colorLevel</span> <span class='kw'>=</span> <span class='st'>"Class"</span>, <span class='kw'>widthFactor</span> <span class='kw'>=</span> <span class='fl'>10</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>abundances</th>
      <td><p>a matrix with taxa as rows and samples as columns</p></td>
    </tr>
    <tr>
      <th>lineages</th>
      <td><p>a matrix with lineages where row names match row names of abundances; first column gives kingdom, following columns give phylum, class, order, family, genus and species (obligatory for SPIEC-EASI)</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>mb or glasso (SPIEC-EASI), any combination of pearson, spearman, bray and/or kld (CoNet), hc, tabu, h2pc, mmhc, rsmax2, aracne, pc.stable, gs, fast.iamb, iamb.fdr, mmpc, hpc or si.hiton.pc (bnlearn, for aracne mi is set to mi-g)</p></td>
    </tr>
    <tr>
      <th>repNum</th>
      <td><p>the number of iterations for CoNet and of bootstrap iterations in SPIEC-EASI and bnlearn; can be omitted (set to 0) for time-intensive bnlearn methods or for CoNet without p-values</p></td>
    </tr>
    <tr>
      <th>minStrength</th>
      <td><p>bnlearn only: the minimum probability for an arc to appear across bootstraps (only applicable if repNum is set larger 1)</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>p-value threshold for bnlearn and CoNet (ignored in methods aracne, hc, tabu, rsmax2, mmhc and h2pc)</p></td>
    </tr>
    <tr>
      <th>renorm</th>
      <td><p>compute correlation p-values in CoNet with renorm enabled (slow)</p></td>
    </tr>
    <tr>
      <th>initEdgeNum</th>
      <td><p>CoNet parameter for the number of initial top and bottom edges</p></td>
    </tr>
    <tr>
      <th>methodNum</th>
      <td><p>CoNet threshold on the minimum method number needed to keep an edge (only used when more than one method is provided)</p></td>
    </tr>
    <tr>
      <th>directed</th>
      <td><p>bnlearn only: infer a directed network (hc, tabu, rsmax2, mmhc and h2pc only infer directed networks, aracne only undirected networks)</p></td>
    </tr>
    <tr>
      <th>nameLevel</th>
      <td><p>the taxonomic level used for node names (only if lineages provided)</p></td>
    </tr>
    <tr>
      <th>colorLevel</th>
      <td><p>the taxonomic level used for node colors (only if lineages provided)</p></td>
    </tr>
    <tr>
      <th>widthFactor</th>
      <td><p>edge width scaling factor</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>igraph object</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For SPIEC-EASI, edge width represents the abolute of the regression coefficients, whereas for bnlearn,
it represents the probability of an arc to re-appear across bootstrap iterations. For CoNet, it either
represents absolute association strength, method number supporting an edge or significance,
depending on whether more than one method was used to compute the network and whether or not
p-values were computed (significance is defined as -log10(pval)). For single dissimilarities in CoNet, edge weight
is scaled (see <code><a href='barebonesCoNet.html'>barebonesCoNet</a></code> for details) such that for all network construction methods,
a thicker edge means a stronger/more stable/more significant association.
For CoNet, p-values are computed by default with cor.test for correlations and permutations and bootstraps
for dissimilarities and are multiple-testing corrected with Benjamini-Hochberg.
P-value computation in CoNet can be disabled by setting repNum to 0.
If applicable, the color code for the node colors is plotted in a separate bar plot.
SPIEC-EASI and CoNet return undirected graphs, whereas bnlearn methods support the inference
of directed graphs. SPIEC-EASI methods tend to be faster than bnlearn methods.
The returned network can be visualized with igraph's interactive network visualisation
function tkplot or simply with igraph's plot function. When RCy3 is installed and Cytoscape is open,
the graph can also be sent to Cytoscape directly with RCy3's function createNetworkFromIgraph().</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>ibd_taxa</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>ibd_lineages</span>)
<span class='no'>top.indices</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span>(<span class='no'>ibd_taxa</span>),<span class='kw'>decreasing</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,<span class='kw'>index.return</span><span class='kw'>=</span><span class='fl'>TRUE</span>)$<span class='no'>ix</span>[<span class='fl'>1</span>:<span class='fl'>30</span>]
<span class='no'>taxa</span><span class='kw'>=</span><span class='no'>ibd_taxa</span>[<span class='no'>top.indices</span>,]
<span class='no'>lineages</span><span class='kw'>=</span><span class='no'>ibd_lineages</span>[<span class='no'>top.indices</span>,]
<span class='no'>hc.out</span><span class='kw'>=</span><span class='fu'>buildNetwork</span>(<span class='no'>taxa</span>,<span class='no'>lineages</span>,<span class='kw'>method</span><span class='kw'>=</span><span class='st'>"hc"</span>,<span class='kw'>nameLevel</span><span class='kw'>=</span><span class='st'>"species"</span>)</div><div class='output co'>#&gt; 
#&gt;   Bayesian network learned via Score-based methods
#&gt; 
#&gt;   model:
#&gt;    [Eubacterium_rectale][Ruminococcus_sp_5_1_39BFAA][Bifidobacterium_longum]
#&gt;    [Akkermansia_muciniphila][Dialister_invisus][Bacteroides_vulgatus]
#&gt;    [Prevotella_copri][Roseburia_intestinalis][Bacteroides_ovatus]
#&gt;    [Streptococcus_thermophilus][Bacteroides_stercoris][Parabacteroides_merdae]
#&gt;    [Enterococcus_faecium][Faecalibacterium_prausnitzii|Eubacterium_rectale]
#&gt;    [Ruminococcus_gnavus|Eubacterium_rectale]
#&gt;    [Ruminococcus_torques|Ruminococcus_sp_5_1_39BFAA]
#&gt;    [Collinsella_aerofaciens|Bifidobacterium_longum]
#&gt;    [Alistipes_onderdonkii|Roseburia_intestinalis]
#&gt;    [Bacteroides_dorei|Parabacteroides_merdae]
#&gt;    [Bacteroides_caccae|Parabacteroides_merdae]
#&gt;    [Parabacteroides_unclassified|Bacteroides_vulgatus]
#&gt;    [Escherichia_coli|Faecalibacterium_prausnitzii]
#&gt;    [Subdoligranulum_unclassified|Ruminococcus_gnavus:Ruminococcus_torques]
#&gt;    [Bifidobacterium_adolescentis|Collinsella_aerofaciens]
#&gt;    [Eubacterium_hallii|Eubacterium_rectale:Ruminococcus_torques]
#&gt;    [Ruminococcus_bromii|Subdoligranulum_unclassified]
#&gt;    [Alistipes_putredinis|Subdoligranulum_unclassified:Bacteroides_stercoris]
#&gt;    [Dorea_longicatena|Ruminococcus_sp_5_1_39BFAA:Bifidobacterium_longum:Eubacterium_hallii]
#&gt;    [Coprococcus_comes|Eubacterium_hallii]
#&gt;    [Bacteroides_uniformis|Alistipes_putredinis]
#&gt;   nodes:                                 30 
#&gt;   arcs:                                  22 
#&gt;     undirected arcs:                     0 
#&gt;     directed arcs:                       22 
#&gt;   average markov blanket size:           1.87 
#&gt;   average neighbourhood size:            1.47 
#&gt;   average branching factor:              0.73 
#&gt; 
#&gt;   learning algorithm:                    Hill-Climbing 
#&gt;   score:                                 BIC (Gauss.) 
#&gt;   penalization coefficient:              2.521713 
#&gt;   tests used in the learning procedure:  1073 
#&gt;   optimized:                             TRUE 
#&gt; 
#&gt; [1] "Carrying out  20 bootstraps to assess edge strengths..."
#&gt; [1] "logLik: 8099.57779267286"
#&gt; [1] "AIC: 8017.57779267286"
#&gt; [1] "BIC: 7892.79736287917"
#&gt;          Eubacterium_rectale Faecalibacterium_prausnitzii 
#&gt;                 "Clostridia"                 "Clostridia" 
#&gt;          Ruminococcus_gnavus             Escherichia_coli 
#&gt;                 "Clostridia"        "Gammaproteobacteria" 
#&gt;   Ruminococcus_sp_5_1_39BFAA Subdoligranulum_unclassified 
#&gt;                 "Clostridia"                 "Clostridia" 
#&gt; Bifidobacterium_adolescentis       Bifidobacterium_longum 
#&gt;             "Actinobacteria"             "Actinobacteria" 
#&gt;      Akkermansia_muciniphila            Dialister_invisus 
#&gt;           "Verrucomicrobiae"              "Negativicutes" 
#&gt;        Bacteroides_uniformis         Ruminococcus_torques 
#&gt;                "Bacteroidia"                 "Clostridia" 
#&gt;         Bacteroides_vulgatus          Ruminococcus_bromii 
#&gt;                "Bacteroidia"                 "Clostridia" 
#&gt;             Prevotella_copri      Collinsella_aerofaciens 
#&gt;                "Bacteroidia"             "Coriobacteriia" 
#&gt;         Alistipes_putredinis            Dorea_longicatena 
#&gt;                "Bacteroidia"                 "Clostridia" 
#&gt;       Roseburia_intestinalis           Bacteroides_ovatus 
#&gt;                 "Clostridia"                "Bacteroidia" 
#&gt;   Streptococcus_thermophilus           Eubacterium_hallii 
#&gt;                    "Bacilli"                 "Clostridia" 
#&gt;        Bacteroides_stercoris       Parabacteroides_merdae 
#&gt;                "Bacteroidia"                "Bacteroidia" 
#&gt;        Alistipes_onderdonkii            Bacteroides_dorei 
#&gt;                "Bacteroidia"                "Bacteroidia" 
#&gt;         Enterococcus_faecium           Bacteroides_caccae 
#&gt;                    "Bacilli"                "Bacteroidia" 
#&gt; Parabacteroides_unclassified            Coprococcus_comes 
#&gt;                "Bacteroidia"                 "Clostridia" </div><div class='output co'>#&gt; <span class='warning'>Warning: number of items to replace is not a multiple of replacement length</span></div><div class='output co'>#&gt; <span class='warning'>Warning: number of items to replace is not a multiple of replacement length</span></div><div class='img'><img src='buildNetwork-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>hc.out</span>)</div><div class='img'><img src='buildNetwork-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Karoline Faust.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


